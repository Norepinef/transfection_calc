<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ç—Ä–∞–Ω—Å—Ñ–µ–∫—Ü–∏–∏ AAV</title>
</head>
<body>

    <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ç—Ä–∞–Ω—Å—Ñ–µ–∫—Ü–∏–∏ AAV</h1>

    <!-- –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ -->
    <div class="input-container">
        <label for="plasmid_helper_concentration">üìè –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è pAAV-Helper (–º–∫–≥/–ø–∏–∫–æ–º–æ–ª—å):</label>
        <input type="number" id="plasmid_helper_concentration" value="1" step="0.01">

        <label for="plasmid_capsid_concentration">üìè –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –∫–∞–ø—Å–∏–¥–∞ (–º–∫–≥/–ø–∏–∫–æ–º–æ–ª—å):</label>
        <input type="number" id="plasmid_capsid_concentration" value="1" step="0.01">

        <label for="plasmid_transgene_concentration">üìè –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω—Å–≥–µ–Ω–∞ (–º–∫–≥/–ø–∏–∫–æ–º–æ–ª—å):</label>
        <input type="number" id="plasmid_transgene_concentration" value="1" step="0.01">

        <label for="plasmid_ratio">üîó –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–∞–∑–º–∏–¥ (pHelper : Capsid : Transgene):</label>
        <input type="text" id="plasmid_ratio" value="1:1:1">

        <label for="volume_work">üß™ –û–±—ä–µ–º –Ω–∞—Ä–∞–±–æ—Ç–∫–∏ (–≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø):</label>
        <select id="volume_type">
            <option value="T175">T175 (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ = 1)</option>
            <option value="–ö–†–£–ì–õ–´–ï 10—Å–º">–ö–†–£–ì–õ–´–ï 10—Å–º (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ = 0.6)</option>
            <option value="5-level cellstack">5-level cellstack (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ = 18)</option>
        </select>

        <label for="coef">üîÑ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ (—Å–º¬≤ ‚Üí –º–ª):</label>
        <input type="text" id="coef" disabled>

        <label for="volume_work_ml">üß™ –û–±—ä–µ–º –Ω–∞—Ä–∞–±–æ—Ç–∫–∏ (–º–ª):</label>
        <input type="number" id="volume_work_ml" value="30" step="0.1">

        <button type="button" id="calculate-btn">üî¢ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
    </div>

    <!-- –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
    <div class="output-container">
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h2>
        <p>üî¢ <strong>–û–±—ä–µ–º –ö–ñ:</strong> <span id="output_KJ"></span></p>
        <p>üî¢ <strong>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –î–ù–ö (–Ω–≥):</strong> <span id="output_total_dna"></span></p>
        <p>üî¢ <strong>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏—Ä—É—Å–Ω—ã—Ö –≥–µ–Ω–æ–º–æ–≤ (VG):</strong> <span id="output_VG"></span></p>
        <p>üî¢ <strong>–û–±—ä–µ–º –º–∏–∫—Å–∞ (–º–ª):</strong> <span id="output_mix"></span></p>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
        function calculate() {
            // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞
            let plasmidHelperConcentration = parseFloat(document.getElementById("plasmid_helper_concentration").value);
            let plasmidCapsidConcentration = parseFloat(document.getElementById("plasmid_capsid_concentration").value);
            let plasmidTransgeneConcentration = parseFloat(document.getElementById("plasmid_transgene_concentration").value);

            // –ü–∞—Ä—Å–∏–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–∞–∑–º–∏–¥
            let plasmidRatio = document.getElementById("plasmid_ratio").value.split(':').map(r => parseFloat(r.trim()));

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π
            if (isNaN(plasmidHelperConcentration) || isNaN(plasmidCapsidConcentration) || isNaN(plasmidTransgeneConcentration) || plasmidRatio.length !== 3) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.");
                return;
            }

            // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –µ–º–∫–æ—Å—Ç–∏ –¥–ª—è –Ω–∞—Ä–∞–±–æ—Ç–∫–∏
            let volumeType = document.getElementById("volume_type").value;
            let coef = 0;

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –µ–º–∫–æ—Å—Ç–∏
            if (volumeType === "T175") {
                coef = 1;
            } else if (volumeType === "–ö–†–£–ì–õ–´–ï 10—Å–º") {
                coef = 0.6;
            } else if (volumeType === "5-level cellstack") {
                coef = 18;
            }

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ –≤ –ø–æ–ª–µ
            document.getElementById("coef").value = coef;

            let volumeWork = parseFloat(document.getElementById("volume_work_ml").value);

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π
            if (isNaN(volumeWork) || isNaN(coef)) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±—ä–µ–º –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ –≤–≤–µ–¥–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.");
                return;
            }

            // –†–∞—Å—á–µ—Ç –æ–±—ä–µ–º–∞ –ö–ñ (ml)
            let KJ = volumeWork * coef;  

            // –†–∞—Å—á–µ—Ç —Å—É–º–º–∞—Ä–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –î–ù–ö –¥–ª—è –≤—Å–µ—Ö —Ç—Ä–µ—Ö –ø–ª–∞–∑–º–∏–¥ —Å —É—á–µ—Ç–æ–º –∏—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π
            let totalDNA = (plasmidHelperConcentration * plasmidRatio[0]) + 
                           (plasmidCapsidConcentration * plasmidRatio[1]) + 
                           (plasmidTransgeneConcentration * plasmidRatio[2]);

            // –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–∏—Ä—É—Å–Ω—ã—Ö –≥–µ–Ω–æ–º–æ–≤ (VG) –∏ –æ–±—ä–µ–º–∞ –º–∏–∫—Å–∞
            let VG = totalDNA * 1e6;  // –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–∏—Ä—É—Å–Ω—ã—Ö –≥–µ–Ω–æ–º–æ–≤ (VG)
            let mixVolume = VG / (10 * 1e6);  // –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è –æ–±—ä–µ–º–∞ –º–∏–∫—Å–∞ (ml)

            // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            document.getElementById("output_KJ").textContent = KJ.toFixed(2) + " –º–ª";
            document.getElementById("output_total_dna").textContent = totalDNA.toFixed(2) + " –Ω–≥";
            document.getElementById("output_VG").textContent = VG.toExponential(2) + " VG";
            document.getElementById("output_mix").textContent = mixVolume.toFixed(2) + " –º–ª";
        }

        // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏—è –∫ –∫–Ω–æ–ø–∫–µ
        document.getElementById("calculate-btn").addEventListener("click", calculate);
    </script>
</body>
</html>
